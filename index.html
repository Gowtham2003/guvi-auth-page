<!DOCTYPE html>
<html lang="en">
  <head>
    <title>GUVI</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!--===============================================================================================-->
    <link rel="icon" type="image/png" href="images/icons/favicon.ico" />
    <!--===============================================================================================-->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    />

    <!--===============================================================================================-->
    <link
      rel="stylesheet"
      type="text/css"
      href="fonts/iconic/css/material-design-iconic-font.min.css"
    />

    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="css/util.css" />
    <link rel="stylesheet" type="text/css" href="css/main.css" />
    <!--===============================================================================================-->
  </head>

  <body>
    <section class="h-100">
      <div class="container h-100">
        <div class="row justify-content-sm-center h-100">
          <div class="col-xxl-4 col-xl-5 col-lg-5 col-md-7 col-sm-9">
            <div class="text-center my-5">
              <img
                src="https://getbootstrap.com/docs/5.0/assets/brand/bootstrap-logo.svg"
                alt="logo"
                width="100"
              />
            </div>
            <div class="card shadow-lg">
              <div class="card-body p-5">
                <h1 class="fs-4 card-title fw-bold mb-4">Login</h1>
                <form id="login-form">
                  <div class="mb-3">
                    <label class="mb-2 text-muted" for="email"
                      >E-Mail Address</label
                    >
                    <input
                      id="email"
                      type="email"
                      class="form-control"
                      name="username"
                      value=""
                      required
                      autofocus
                    />
                    <div class="invalid-feedback">Email is invalid</div>
                  </div>

                  <div class="mb-3">
                    <div class="mb-2 w-100">
                      <label class="text-muted" for="password">Password</label>
                    </div>
                    <input
                      id="password"
                      type="password"
                      class="form-control"
                      name="password"
                      required
                    />
                    <div class="invalid-feedback">Password is required</div>
                  </div>

                  <div class="d-flex align-items-center">
                    <button type="submit" class="btn btn-primary ms-auto">
                      Login
                    </button>
                  </div>
                </form>
              </div>
              <div class="card-footer py-3 border-0">
                <div class="text-center">
                  Don't have an account?
                  <a href="register.html" class="text-dark">Create One</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!--===============================================================================================-->
    <script src="vendor/jquery/jquery-3.2.1.min.js"></script>
    <!--===============================================================================================-->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"
    ></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

    <script src="js/main.js"></script>
    <script>
      // check if user is logged in or not
      $.ajax({
        type: "GET",
        url: "php/auth.php",
        success: function (data) {
          window.location.href = "dashboard.html";
        },
      });
      $("#login-form").submit(function (e) {
        e.preventDefault();
        var form = $(this);

        $.ajax({
          type: "POST",
          url: "php/login.php",
          data: form.serialize(), // serializes the form's elements.
          success: function (data) {
            console.log(data);
            if (data["success"]) {
              swal({
                icon: "success",
                title: "Success",
                text: data["message"],
              }).then(function () {
                window.location.href = "dashboard.html";
              });
            } else {
              swal({
                icon: "error",
                title: "Logic failed",
                text: data["message"],
              });
            }
          },
          error: function (xhr, status, error) {
            swal("Error!", "Could not process your request!", "error");
            console.log("Error:", error);
          },
        });
      });
    </script>
  </body>
</html>
